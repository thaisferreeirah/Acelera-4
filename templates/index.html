<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Controle de Acesso Escolar</title>
    <link rel="stylesheet" href="../static/fontawesome-free-6.7.2-web/css/all.min.css">
    <link rel="stylesheet" href="../static/style.css">
</head>
<script>

    // Simula a tabela sendo preenchida
    document.addEventListener('DOMContentLoaded', function () {
        const recentAccessData = [
            { date: "10/05/2023 08:15", name: "João Silva", id: "2023001", type: "Entrada", method: "Facial" },
            { date: "10/05/2023 08:20", name: "Maria Oliveira", id: "2023002", type: "Entrada", method: "Facial" },
            { date: "10/05/2023 09:05", name: "Carlos Souza", id: "2023003", type: "Entrada", method: "Cartão" },
            { date: "10/05/2023 10:30", name: "Ana Costa", id: "2023004", type: "Saída", method: "Facial" },
            { date: "10/05/2023 11:45", name: "Pedro Santos", id: "2023005", type: "Entrada", method: "Facial" }
        ];

        const tableBody = document.getElementById('recentAccessTable');

        recentAccessData.forEach((item, index) => {
            const row = document.createElement('tr');
            row.innerHTML = `
        <td>${item.date}</td>
        <td>${item.name}</td>
        <td>${item.id}</td>
        <td><span class="access-type ${item.type.toLowerCase()}">${item.type}</span></td>
        <td>${item.method}</td>
      `;
            tableBody.appendChild(row);
        });
    });

    // Animação para simular reconhecimento facial
    function simulateAccess() {
        const video = document.getElementById('video');
        const recognitionControls = document.querySelector('.recognition-controls');

        // Efeito visual de reconhecimento
        video.style.border = "3px solid var(--verde-limao)";
        video.style.boxShadow = "0 0 20px rgba(165, 214, 16, 0.7)";

        // Desabilita botões durante o processo
        recognitionControls.querySelectorAll('button').forEach(btn => {
            btn.disabled = true;
            btn.style.opacity = "0.7";
        });

        // Simula tempo de processamento
        setTimeout(() => {
            video.style.border = "3px solid var(--verde-militar)";
            video.style.boxShadow = "none";

            // Recria o efeito de sucesso
            const successEffect = document.createElement('div');
            successEffect.style.position = "absolute";
            successEffect.style.top = "0";
            successEffect.style.left = "0";
            successEffect.style.width = "100%";
            successEffect.style.height = "100%";
            successEffect.style.background = "rgba(165, 214, 16, 0.3)";
            successEffect.style.borderRadius = "7px";
            successEffect.style.animation = "fadeOut 1s ease forwards";

            document.querySelector('.video-container').appendChild(successEffect);

            // Habilita botões novamente
            recognitionControls.querySelectorAll('button').forEach(btn => {
                btn.disabled = false;
                btn.style.opacity = "1";
            });

            // Notificação de sucesso
            alert("Acesso liberado para: Aluno Exemplo\nMatrícula: 2023001");
        }, 2000);
    }

    // Adiciona classe dinâmica para os tipos de acesso
    document.addEventListener('DOMContentLoaded', function () {
        setTimeout(() => {
            document.querySelectorAll('.access-type').forEach(el => {
                if (el.textContent === 'Entrada') {
                    el.classList.add('entrada');
                } else {
                    el.classList.add('saida');
                }
            });
        }, 600);
    });
</script>

<body>
    <div id="menu-container"></div>

    <main class="main-content">
        <div class="card">
            <div class="card-header">
                <h2><i class="fas fa-chart-line"></i> Resumo de Acessos</h2>
            </div>
            <p>Bem-vindo ao sistema de controle de acesso por reconhecimento facial.</p>

            <div class="face-recognition">
                <div class="video-container">
                    <div style="position: relative; width: 500px; height: 350px;">
                        <iframe width="560" height="315" src="https://www.youtube.com/embed/dQw4w9WgXcQ?autoplay=1"
                            frameborder="0" allowfullscreen style="position: absolute; top: 0; left: 0;">
                        </iframe>
                        <img src="../static/images/3.png"
                            style="position: absolute; top: 0; left: 0; width: 100%; cursor: pointer;"
                            onclick="this.style.display='none'">
                    </div>
                </div>

            </div>
        </div>

        <div class="card">
            <div class="card-header">
                <h2><i class="fas fa-bell"></i> Últimos Acessos</h2>
                <a href="/historico">Ver todos</a>
            </div>

            <table class="table">
                <thead>
                    <tr>
                        <th>Data/Hora</th>
                        <th>Aluno</th>
                        <th>Matrícula</th>
                        <th>Tipo</th>
                        <th>Método</th>
                    </tr>
                </thead>
                <tbody id="recentAccessTable">
                    <!-- Preenchido por JavaScript -->
                </tbody>
            </table>
        </div>
    </main>
    <script src="js/face-api.min.js"></script>
    <script src="js/script.js"></script>
    <script src="../static/js/script.js"></script>
</body>

</html>